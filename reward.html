<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¥–åŠ±ç»“ç®— - GAGA GAME</title>
  <link rel="stylesheet" href="src/style.css">
  <link rel="stylesheet" href="src/reward.css">
</head>

<body>
  <div class="reward-page">
    <div class="reward-header">
      <div class="logo-circle">ğŸ</div>
      <h1>å¥–åŠ±ç»“ç®—</h1>
      <p>éšæœºæŠ½å–æ¸¸æˆå¥–åŠ±ï¼Œè®©æ¸¸æˆæ›´æœ‰è¶£ï¼</p>
    </div>

    <div class="reward-container">
      <button class="reward-button" onclick="showRewardResult()">
        ğŸ² å¼€å§‹å¥–åŠ±ç»“ç®—
      </button>

      <a href="gaga.html" class="back-button">
        â† è¿”å›ä¸»é¡µ
      </a>

      <a href="reward-config.html" class="back-button" >
        âš™ï¸ å¥–åŠ±é…ç½®
      </a>

      <div class="reward-history">
        <h3>ğŸ¯ å¥–åŠ±å†å²</h3>
        <div id="rewardHistory">
          <div class="history-item">
            <div class="title">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹ç»“ç®—</div>
            <div class="desc">æ¯æ¬¡ç»“ç®—éƒ½ä¼šéšæœºç”Ÿæˆä¸åŒçš„å¥–åŠ±</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="toast"></div>

  <script src="src/config.js"></script>
  <script>
    // å¥–åŠ±å†å²è®°å½•
    let rewardHistory = [];

    // å¥–åŠ±ç»“ç®—å‡½æ•°
    function showRewardResult() {
      // éšæœºæŠ½å–titleå’Œdesc
      const randomTitle = rewardTitles[Math.floor(Math.random() * rewardTitles.length)];
      const randomDesc = rewardDescs[Math.floor(Math.random() * rewardDescs.length)];
      const randomIcon = icons[Math.floor(Math.random() * icons.length)];
      const randomColor = colors[Math.floor(Math.random() * colors.length)];
      const randomBg = bgGradients[Math.floor(Math.random() * bgGradients.length)];
      
      // åˆ›å»ºå¥–åŠ±ç»“ç®—å¼¹çª—
      const rewardModal = document.createElement('div');
      rewardModal.className = 'modal';
      rewardModal.style.display = 'block';
      rewardModal.style.zIndex = '9999';
      rewardModal.innerHTML = `
        <div class="modal-content" style="
          max-width: 450px;
          background: ${randomBg};
          border: 3px solid ${randomColor};
          border-radius: 20px;
          box-shadow: 0 15px 35px rgba(0,0,0,0.3);
          animation: rewardModalSlideIn 0.5s ease-out;
        ">
          <div class="modal-header" style="
            background: transparent;
            border-bottom: 2px solid ${randomColor};
            padding: 20px 30px 15px;
          ">
            <h2 style="
              color: ${randomColor};
              font-size: 1.8rem;
              font-weight: 700;
              margin: 0;
              text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            ">ğŸ å¥–åŠ±ç»“ç®—</h2>
            <span class="close" onclick="closeRewardModal()" style="
              color: ${randomColor};
              font-size: 2rem;
              font-weight: bold;
            ">&times;</span>
          </div>
          <div class="modal-body" style="padding: 30px; text-align: center;">
            <div class="reward-icon" style="
              font-size: 5rem;
              margin-bottom: 20px;
              animation: rewardIconBounce 0.8s ease-in-out;
            ">${randomIcon}</div>
            <h3 style="
              color: ${randomColor};
              font-size: 1.6rem;
              margin: 15px 0;
              font-weight: 700;
              text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            ">${randomTitle}</h3>
            <div class="reward-amount" style="
              background: rgba(255,255,255,0.9);
              padding: 15px 25px;
              border-radius: 20px;
              margin: 20px 0;
              display: inline-block;
              box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            ">
              <span style="
                color: #dc3545;
                font-size: 1.4rem;
                font-weight: 700;
              ">ğŸ’° ${randomDesc}</span>
            </div>
            <div class="reward-congrats" style="
              margin-top: 25px;
              padding: 15px;
              background: rgba(255,255,255,0.4);
              border-radius: 15px;
              font-size: 1.1rem;
              color: #495057;
              font-weight: 600;
            ">ğŸ‰ æ­å–œè·å¾—å¥–åŠ±ï¼</div>
          </div>
        </div>
      `;
      
      document.body.appendChild(rewardModal);
      document.body.style.overflow = 'hidden';
      
      // æ·»åŠ åˆ°å†å²è®°å½•
      addToHistory(randomTitle, randomDesc, randomIcon);
    }

    function closeRewardModal() {
      const rewardModal = document.querySelector('.modal[style*="z-index: 9999"]');
      if (rewardModal) {
        rewardModal.remove();
        document.body.style.overflow = 'auto';
      }
    }

    function addToHistory(title, desc, icon) {
      const timestamp = new Date().toLocaleString('zh-CN');
      const historyItem = {
        title: title,
        desc: desc,
        icon: icon,
        timestamp: timestamp
      };
      
      rewardHistory.unshift(historyItem);
      
      // åªä¿ç•™æœ€è¿‘10æ¡è®°å½•
      if (rewardHistory.length > 10) {
        rewardHistory = rewardHistory.slice(0, 10);
      }
      
      updateHistoryDisplay();
    }

    function updateHistoryDisplay() {
      const historyContainer = document.getElementById('rewardHistory');
      
      if (rewardHistory.length === 0) {
        historyContainer.innerHTML = `
          <div class="history-item">
            <div class="title">æš‚æ— å¥–åŠ±è®°å½•</div>
            <div class="desc">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹ç»“ç®—</div>
          </div>
        `;
        return;
      }
      
      let html = '';
      rewardHistory.forEach((item, index) => {
        html += `
          <div class="history-item">
            <div class="title">${item.icon} ${item.title}</div>
            <div class="desc">${item.desc}</div>
            <div class="desc" style="font-size: 0.8rem; color: #adb5bd; margin-top: 5px;">
              ${item.timestamp}
            </div>
          </div>
        `;
      });
      
      historyContainer.innerHTML = html;
    }

    // Toastæç¤ºå‡½æ•°
    function showToast(msg, type = 'success') {
      let toast = document.querySelector('.toast');
      if (!toast) {
        toast = document.createElement('div');
        toast.className = 'toast';
        document.body.appendChild(toast);
      }
      
      toast.textContent = msg;
      toast.className = `toast ${type}`;
      
      // å¼ºåˆ¶é‡ç»˜ä»¥ç¡®ä¿åŠ¨ç”»æ•ˆæœ
      toast.offsetHeight;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
        // åŠ¨ç”»ç»“æŸåæ¸…ç†
        setTimeout(() => {
          if (toast.parentNode) {
            toast.parentNode.removeChild(toast);
          }
        }, 300);
      }, 2000);
    }

    // ç‚¹å‡»å¼¹çª—å¤–éƒ¨åŒºåŸŸå…³é—­å¼¹çª—
    window.onclick = function(event) {
      if (event.target.classList.contains('modal') && event.target.style.zIndex === '9999') {
        closeRewardModal();
      }
    }

    // é”®ç›˜å¿«æ·é”®æ”¯æŒ
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeRewardModal();
      }
    });

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–å†å²è®°å½•æ˜¾ç¤º
    document.addEventListener('DOMContentLoaded', function() {
      updateHistoryDisplay();
    });
  </script>
</body>

</html> 